{
  "version": 3,
  "sources": ["../index.ts"],
  "sourcesContent": ["import express from \"express\";\nimport session from \"express-session\";\nimport expressLayouts from \"express-ejs-layouts\";\nimport { eventInfo, eventData, createEventData, deleteEventData } from \"./EventActions\"\n\nconst app = express();\n\napp.set(\"view engine\", \"ejs\");\napp.use(expressLayouts);\napp.use(express.json())\n\napp.set(\"trust proxy\", 1); // trust first proxy\n\nconst server = require(\"http\").createServer(app);\nconst io = require(\"socket.io\")(server);\n\nconst token = \"6227ea2c7aabff48117758b7\";\n\ninterface Event {\n    _id: any,\n    title: string,\n    budget: number,\n    datetime: string,\n    location: string,\n    cost: number,\n    private: boolean,\n    contact: Object,\n    banner: string,\n    categories: Array,\n    pageStyle: string,\n    attributes: Object,\n    groupName: string\n}\n\nconst sessionMiddleware = session({\n  secret: \"keyboard cat\",\n  resave: true,\n  saveUninitialized: true,\n  cookie: { secure: true },\n});\n\napp.use(sessionMiddleware);\n\nio.use((socket: any, next: any) => sessionMiddleware(socket.request, {}, next));\n\nio.on(\"connection\", (socket: any) => {\n  socket.join(token);\n  console.log(\"New user: \" + socket.id);\n  socket.on(\"chat-message\", (data: any) => {\n    io.to(token).emit(\"chat-message\", data);\n  });\n\n  socket.on(\"add-menu\", async (data: any) => {\n    data.parent = new ObjectId(data.parent);\n\t\tdata.categories = data.categories.filter(String)\n    let res = await createEventData(data, \"Food\");\n    let d = {\n      ...data,\n      _id: res.insertedId.toString(),\n    };\n    console.log(d);\n    io.to(token).emit(\"add-menu-res\", d);\n  });\n\n\tsocket.on(\"delete-menu\", async (id: string) => {\n\t\ttry {\n\t    let res = await deleteEventData(id, \"Food\");\n\t\t} catch (err) {\n\t\t\tconsole.log(err)\n\t\t}\n    io.to(token).emit(\"delete-menu-res\", id);\n  });\n\n  socket.on(\"disconnect\", () => {\n    io.to(token).emit(\"chat-message\", {\n      user: {\n        name: \"Manu\",\n        email: \"manuthecoder@protonmail.com\",\n        image:\n          \"https://replit.com/cdn-cgi/image/width=1920,quality=80/https://storage.googleapis.com/replit/images/1615307601188_444d33267b0ab288b076f21da2abafc2.jpeg\",\n      },\n      event: \"6227ea2c7aabff48117758b7\",\n      msg: \"Manu has left the event\",\n      short: true,\n    });\n  });\n});\n\napp.use(async (req, res, next) => {\n  if (req.path.startsWith(\"/events/\")) {\n    res.render(\"event-page\", {\n      event: await eventInfo(req.path.replace(\"/events/\", \"\"), req),\n      layout: false,\n    });\n  }\n  next();\n});\n\napp.get([\"/\", \"/pages/event-website\"], async (req: any, res: any) => {\n  res.render(\n    req.path == \"/pages/event-website\" ? \"pages/event-website\" : \"index\",\n    {\n      event: await eventInfo(token, req),\n      layout: false,\n    }\n  );\n});\n\napp.post(\"/add-attendee\", async (req: any, res: any) => {\n\tconsole.log(req.body)\n\tlet eventData = await createEventData({\n\t\tname: req.body.name,\n\t\temail: req.body.email,\n\t\tattributes: req.body.attributes,\n\t\tphone: req.body.phone,\n\t\tparent: new ObjectId(req.body.parent)\n\t}, \"Attendees\");\n\tconsole.log(eventData);\n\tres.json([ true ]);\n});\n\napp.get(\"/pages/overview\", async (req: any, res: any) => {\n  res.render(\"pages/overview\", {\n    event: await eventInfo(token, req),\n    layout: false,\n  });\n});\n\napp.get(\"/pages/menu\", async (req: any, res: any) => {\n  res.render(\"pages/menu\", {\n    data: await eventData(token, \"Food\"),\n    layout: false,\n  });\n});\n\napp.get(\"/pages/attendees\", async (req: any, res: any) => {\n  res.render(\"pages/attendees\", {\n    data: await eventData(token, \"Attendees\"),\n    layout: false,\n  });\n});\n\napp.get(\"/pages/lists\", async (req: any, res: any) => {\n  res.render(\"pages/lists\", {\n    data: await eventData(token, \"Lists\"),\n    layout: false,\n  });\n});\n\napp.get(\"/pages/items\", async (req: any, res: any) => {\n  res.render(\"pages/items\", {\n    data: await eventData(token, \"Items\"),\n    layout: false,\n  });\n});\n\n\tapp.get(\"/pages/outline\", async (req: any, res: any) => {\n  res.render(\"pages/outline\", {\n    data: await eventData(token, \"Outline\"),\n    layout: false,\n  });\n});\n\napp.use(express.static(\"src\"));\n\napp.get(\"/js/app.js\", (req, res) => {\n  res.sendFile(__dirname + \"/src/js/app.js\");\n});\n\napp.get(\"/dist/build.css\", (req, res) => {\n  res.sendFile(\"/home/runner/Events5/dist/output.css\");\n});\n\nconst port = process.env.PORT ?? 443;\nserver.listen(port, () =>\n  console.log({\n    message: \"Smartlist collaborate is UP\",\n    product: \"Smartlist Collaborate\",\n    status: \"UP\",\n    timestamp: new Date(),\n  })\n);\n"],
  "mappings": "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",
  "names": []
}
